<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Introduction to Data Analysis with R &amp; Reproducible Data Science</title>
  <meta name="description" content="Introduction to Data Analysis with R &amp; Reproducible Data Science">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="Introduction to Data Analysis with R &amp; Reproducible Data Science" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="IRSAAtUMn/RWorkshop17/docs" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introduction to Data Analysis with R &amp; Reproducible Data Science" />
  
  
  

<meta name="author" content="Institute for Research in Statistics and its Applications at the University of Minnesota">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="simple-statistics-in-r.html">
<link rel="next" href="using-r-reproducibly.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<script src="libs/datatables-binding-0.2/datatables.js"></script>
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.12/js/jquery.dataTables.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Home</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r-rstudio.html"><a href="introduction-to-r-rstudio.html"><i class="fa fa-check"></i><b>1</b> Introduction to R &amp; RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r-rstudio.html"><a href="introduction-to-r-rstudio.html#getting-started"><i class="fa fa-check"></i><b>1.1</b> Getting Started</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r-rstudio.html"><a href="introduction-to-r-rstudio.html#basic-features"><i class="fa fa-check"></i><b>1.2</b> Basic features</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r-rstudio.html"><a href="introduction-to-r-rstudio.html#getting-help"><i class="fa fa-check"></i><b>1.3</b> Getting Help</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r-rstudio.html"><a href="introduction-to-r-rstudio.html#working-with-data"><i class="fa fa-check"></i><b>1.4</b> Working with data</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r-rstudio.html"><a href="introduction-to-r-rstudio.html#exercises"><i class="fa fa-check"></i><b>1.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>2</b> Data Visualization</a><ul>
<li class="chapter" data-level="2.1" data-path="data-visualization.html"><a href="data-visualization.html#ggplot"><i class="fa fa-check"></i><b>2.1</b> ggplot</a></li>
<li class="chapter" data-level="2.2" data-path="data-visualization.html"><a href="data-visualization.html#univariate-visualizations"><i class="fa fa-check"></i><b>2.2</b> Univariate visualizations</a></li>
<li class="chapter" data-level="2.3" data-path="data-visualization.html"><a href="data-visualization.html#visualizing-relationships"><i class="fa fa-check"></i><b>2.3</b> Visualizing Relationships</a></li>
<li class="chapter" data-level="2.4" data-path="data-visualization.html"><a href="data-visualization.html#exercises-1"><i class="fa fa-check"></i><b>2.4</b> Exercises</a></li>
<li class="chapter" data-level="2.5" data-path="data-visualization.html"><a href="data-visualization.html#extra"><i class="fa fa-check"></i><b>2.5</b> Extra</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html"><i class="fa fa-check"></i><b>3</b> Simple Statistics in R</a><ul>
<li class="chapter" data-level="3.1" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#chapter-outline-and-goals"><i class="fa fa-check"></i><b>3.1</b> Chapter Outline and Goals</a></li>
<li class="chapter" data-level="3.2" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#minnesota-beer-data"><i class="fa fa-check"></i><b>3.2</b> Minnesota Beer Data</a><ul>
<li class="chapter" data-level="3.2.1" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#overview"><i class="fa fa-check"></i><b>3.2.1</b> Overview</a></li>
<li class="chapter" data-level="3.2.2" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#load-the-data"><i class="fa fa-check"></i><b>3.2.2</b> Load the Data</a></li>
<li class="chapter" data-level="3.2.3" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#look-at-the-data"><i class="fa fa-check"></i><b>3.2.3</b> Look at the Data</a></li>
<li class="chapter" data-level="3.2.4" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#plot-the-data"><i class="fa fa-check"></i><b>3.2.4</b> Plot the Data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#descriptive-statistics-in-r"><i class="fa fa-check"></i><b>3.3</b> Descriptive Statistics in R</a><ul>
<li class="chapter" data-level="3.3.1" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#overview-1"><i class="fa fa-check"></i><b>3.3.1</b> Overview</a></li>
<li class="chapter" data-level="3.3.2" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#minimum-and-maximum"><i class="fa fa-check"></i><b>3.3.2</b> Minimum and Maximum</a></li>
<li class="chapter" data-level="3.3.3" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#mean-standard-deviation-and-variance"><i class="fa fa-check"></i><b>3.3.3</b> Mean, Standard Deviation, and Variance</a></li>
<li class="chapter" data-level="3.3.4" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#medians-and-quantiles"><i class="fa fa-check"></i><b>3.3.4</b> Medians and Quantiles</a></li>
<li class="chapter" data-level="3.3.5" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#factor-level-information"><i class="fa fa-check"></i><b>3.3.5</b> Factor Level Information</a></li>
<li class="chapter" data-level="3.3.6" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#covariances-and-correlations"><i class="fa fa-check"></i><b>3.3.6</b> Covariances and Correlations</a></li>
<li class="chapter" data-level="3.3.7" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#applying-functions-to-multiple-variables"><i class="fa fa-check"></i><b>3.3.7</b> Applying Functions to Multiple Variables</a></li>
<li class="chapter" data-level="3.3.8" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#applying-functions-at-levels-of-factors"><i class="fa fa-check"></i><b>3.3.8</b> Applying Functions at Levels of Factors</a></li>
<li class="chapter" data-level="3.3.9" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#making-a-table"><i class="fa fa-check"></i><b>3.3.9</b> Making a Table</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#students-t-test-in-r"><i class="fa fa-check"></i><b>3.4</b> Student’s t-Test in R</a><ul>
<li class="chapter" data-level="3.4.1" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#one-sample-t-test"><i class="fa fa-check"></i><b>3.4.1</b> One Sample t-Test</a></li>
<li class="chapter" data-level="3.4.2" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#two-sample-t-test"><i class="fa fa-check"></i><b>3.4.2</b> Two Sample t-Test</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#one-way-anova-in-r"><i class="fa fa-check"></i><b>3.5</b> One-Way ANOVA in R</a><ul>
<li class="chapter" data-level="3.5.1" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#omnibus-f-test"><i class="fa fa-check"></i><b>3.5.1</b> Omnibus F-Test</a></li>
<li class="chapter" data-level="3.5.2" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#pairwise-comparisons-tukeys-hsd"><i class="fa fa-check"></i><b>3.5.2</b> Pairwise Comparisons (Tukey’s HSD)</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#correlation-tests-in-r"><i class="fa fa-check"></i><b>3.6</b> Correlation Tests in R</a></li>
<li class="chapter" data-level="3.7" data-path="simple-statistics-in-r.html"><a href="simple-statistics-in-r.html#exercises-2"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html"><i class="fa fa-check"></i><b>4</b> Linear Regression in R</a><ul>
<li class="chapter" data-level="4.1" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#chapter-outline-and-goals-1"><i class="fa fa-check"></i><b>4.1</b> Chapter Outline and Goals</a></li>
<li class="chapter" data-level="4.2" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#minnesota-beer-data-reminder"><i class="fa fa-check"></i><b>4.2</b> Minnesota Beer Data (Reminder)</a><ul>
<li class="chapter" data-level="4.2.1" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#overview-2"><i class="fa fa-check"></i><b>4.2.1</b> Overview</a></li>
<li class="chapter" data-level="4.2.2" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#load-and-look-at-the-data"><i class="fa fa-check"></i><b>4.2.2</b> Load and Look at the Data</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#simple-linear-regression"><i class="fa fa-check"></i><b>4.3</b> Simple Linear Regression</a><ul>
<li class="chapter" data-level="4.3.1" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#fit-the-model"><i class="fa fa-check"></i><b>4.3.1</b> Fit the Model</a></li>
<li class="chapter" data-level="4.3.2" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#inference-information"><i class="fa fa-check"></i><b>4.3.2</b> Inference Information</a></li>
<li class="chapter" data-level="4.3.3" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#plot-the-regression-line"><i class="fa fa-check"></i><b>4.3.3</b> Plot the Regression Line</a></li>
<li class="chapter" data-level="4.3.4" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#diagnostic-and-influence-plots"><i class="fa fa-check"></i><b>4.3.4</b> Diagnostic and Influence Plots</a></li>
<li class="chapter" data-level="4.3.5" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#predction-for-new-data"><i class="fa fa-check"></i><b>4.3.5</b> Predction for New Data</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#multiple-linear-regression"><i class="fa fa-check"></i><b>4.4</b> Multiple Linear Regression</a><ul>
<li class="chapter" data-level="4.4.1" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#overview-3"><i class="fa fa-check"></i><b>4.4.1</b> Overview</a></li>
<li class="chapter" data-level="4.4.2" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#additive-effects"><i class="fa fa-check"></i><b>4.4.2</b> Additive Effects</a></li>
<li class="chapter" data-level="4.4.3" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#interaction-effects"><i class="fa fa-check"></i><b>4.4.3</b> Interaction Effects</a></li>
<li class="chapter" data-level="4.4.4" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#comparing-fit-models"><i class="fa fa-check"></i><b>4.4.4</b> Comparing Fit Models</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#exercises-3"><i class="fa fa-check"></i><b>4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="using-r-reproducibly.html"><a href="using-r-reproducibly.html"><i class="fa fa-check"></i><b>5</b> Using R Reproducibly</a><ul>
<li class="chapter" data-level="5.1" data-path="using-r-reproducibly.html"><a href="using-r-reproducibly.html#types-of-reproducibility"><i class="fa fa-check"></i><b>5.1</b> Types of Reproducibility</a></li>
<li class="chapter" data-level="5.2" data-path="using-r-reproducibly.html"><a href="using-r-reproducibly.html#general-principles-of-reproducibility"><i class="fa fa-check"></i><b>5.2</b> General Principles of Reproducibility</a><ul>
<li class="chapter" data-level="5.2.1" data-path="using-r-reproducibly.html"><a href="using-r-reproducibly.html#dont-do-things-by-hand"><i class="fa fa-check"></i><b>5.2.1</b> Don’t do things by hand</a></li>
<li class="chapter" data-level="5.2.2" data-path="using-r-reproducibly.html"><a href="using-r-reproducibly.html#automate-where-you-can"><i class="fa fa-check"></i><b>5.2.2</b> Automate where you can</a></li>
<li class="chapter" data-level="5.2.3" data-path="using-r-reproducibly.html"><a href="using-r-reproducibly.html#use-version-control"><i class="fa fa-check"></i><b>5.2.3</b> Use Version Control</a></li>
<li class="chapter" data-level="5.2.4" data-path="using-r-reproducibly.html"><a href="using-r-reproducibly.html#document-your-environment"><i class="fa fa-check"></i><b>5.2.4</b> Document your environment</a></li>
<li class="chapter" data-level="5.2.5" data-path="using-r-reproducibly.html"><a href="using-r-reproducibly.html#document-your-analysis"><i class="fa fa-check"></i><b>5.2.5</b> Document your analysis</a></li>
<li class="chapter" data-level="5.2.6" data-path="using-r-reproducibly.html"><a href="using-r-reproducibly.html#make-your-data-open"><i class="fa fa-check"></i><b>5.2.6</b> Make your data open</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="using-r-reproducibly.html"><a href="using-r-reproducibly.html#starting-a-reproducible-workflow-in-r"><i class="fa fa-check"></i><b>5.3</b> Starting a Reproducible Workflow in R</a><ul>
<li class="chapter" data-level="5.3.1" data-path="using-r-reproducibly.html"><a href="using-r-reproducibly.html#organization"><i class="fa fa-check"></i><b>5.3.1</b> Organization</a></li>
<li class="chapter" data-level="5.3.2" data-path="using-r-reproducibly.html"><a href="using-r-reproducibly.html#anantomy-of-a-script"><i class="fa fa-check"></i><b>5.3.2</b> Anantomy of a script</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Data Analysis with R &amp; Reproducible Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-regression-in-r" class="section level1">
<h1><span class="header-section-number"> 4</span> Linear Regression in R</h1>
<p><em>Author: Nathan Helwig</em></p>
<div id="chapter-outline-and-goals-1" class="section level2">
<h2><span class="header-section-number">4.1</span> Chapter Outline and Goals</h2>
<p>In this chapter, we will cover how to…</p>
<ul>
<li>Fit simple and multiple linear regression models</li>
<li>Test the significance of regression coefficients</li>
<li>Plot and interpret the regression results</li>
<li>Make predictions from fit regression models</li>
</ul>
<p>R’s <strong>lm</strong> (linear model) function will be the primary tool used in the chapter.</p>
</div>
<div id="minnesota-beer-data-reminder" class="section level2">
<h2><span class="header-section-number">4.2</span> Minnesota Beer Data (Reminder)</h2>
<div id="overview-2" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Overview</h3>
<p>The Minnesota beer data has 44 beers measured on 7 variables:</p>
<ol style="list-style-type: decimal">
<li><em>Brewery</em>: Name of the brewery (<strong>factor</strong> with 8 levels)</li>
<li><em>Beer</em>: Name of the beer (<strong>factor</strong> with 44 levels)</li>
<li><em>Description</em>: Description of the beer (<strong>factor</strong> with 37 levels)</li>
<li><em>Style</em>: Style of the beer (<strong>factor</strong> with 3 levels)</li>
<li><em>ABV</em>: Alcohol by volume (<strong>numeric</strong>)</li>
<li><em>IBU</em>: International bitterness units (<strong>integer</strong>)</li>
<li><em>Rating</em>: Beer Advocate rating (<strong>integer</strong>)</li>
</ol>
<p>Data obtained by NEH from <a href="http://beeradvocate.com">Beer Advocate</a> and the websites of the eight breweries.</p>
</div>
<div id="load-and-look-at-the-data" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Load and Look at the Data</h3>
<p>Use the <strong>read.csv</strong> function to load the <em>beer</em> data into R</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">beer &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;http://users.stat.umn.edu/~helwig/notes/MNbeer.csv&quot;</span>)</code></pre></div>
<p>The <strong>head</strong> function returns the first six lines of a data frame</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(beer)
##       Brewery         Beer              Description Style ABV IBU
## 1     Bauhaus  Wonderstuff     New Bohemian Pilsner Lager 5.4  48
## 2     Bauhaus    Stargazer German Style Schwarzbier Lager 5.0  28
## 3     Bauhaus  Wagon Party    West Cost Style Lager Lager 5.4  55
## 4     Bauhaus    Sky-Five!        Midwest Coast IPA   IPA 6.7  70
## 5 Bent Paddle         Kanu         Session Pale Ale   Ale 4.8  48
## 6 Bent Paddle Venture Pils            Pilsner Lager Lager 5.0  38
##   Rating
## 1     88
## 2     87
## 3     86
## 4     86
## 5     85
## 6     87</code></pre></div>
</div>
</div>
<div id="simple-linear-regression" class="section level2">
<h2><span class="header-section-number">4.3</span> Simple Linear Regression</h2>
<div id="fit-the-model" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Fit the Model</h3>
<p>Consider a simple linear regression model of the form <span class="math display">\[
y_i = \beta_0 + \beta_1 x_i + \epsilon_i
\]</span> where <span class="math inline">\(y_i\)</span> is the Rating of the <em>i</em>-th beer (response), <span class="math inline">\(x_i\)</span> is the ABV of the <em>i</em>-th beer (predictor), <span class="math inline">\(\beta_0\)</span> is the unknown regression intercept, <span class="math inline">\(\beta_1\)</span> is the unknown regression slope, and <span class="math inline">\(\epsilon_i \sim \mathrm{N}(0, \sigma^2)\)</span> is a latent Gaussian error term. To fit the model, we can use the <strong>lm</strong> function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod &lt;-<span class="st"> </span><span class="kw">lm</span>(Rating ~<span class="st"> </span>ABV, <span class="dt">data =</span> beer)</code></pre></div>
<p>The first input is the regression formula (Response ~ Predictor), and the second input is the data frame containing the variables in the regression formula. Note that <em>mod</em> is an object of class <em>lm</em>, which is a list containing information about the fit model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(mod)
## [1] &quot;lm&quot;
<span class="kw">names</span>(mod)
##  [1] &quot;coefficients&quot;  &quot;residuals&quot;     &quot;effects&quot;       &quot;rank&quot;         
##  [5] &quot;fitted.values&quot; &quot;assign&quot;        &quot;qr&quot;            &quot;df.residual&quot;  
##  [9] &quot;xlevels&quot;       &quot;call&quot;          &quot;terms&quot;         &quot;model&quot;</code></pre></div>
<p>For example, the <em>$coefficients</em> element contains the estimated regression coefficients</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod$coefficients
## (Intercept)         ABV 
##       74.03        2.26</code></pre></div>
<p>which reveal that the expected Rating increases by about 2.26 points for every 1 unit (i.e., 1%) increaese in ABV.</p>
</div>
<div id="inference-information" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Inference Information</h3>
<p>To obtain a more detailed summary of the fit model, use the <strong>summary</strong> function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">modsum &lt;-<span class="st"> </span><span class="kw">summary</span>(mod)
<span class="kw">names</span>(modsum)
##  [1] &quot;call&quot;          &quot;terms&quot;         &quot;residuals&quot;     &quot;coefficients&quot; 
##  [5] &quot;aliased&quot;       &quot;sigma&quot;         &quot;df&quot;            &quot;r.squared&quot;    
##  [9] &quot;adj.r.squared&quot; &quot;fstatistic&quot;    &quot;cov.unscaled&quot;
modsum
## 
## Call:
## lm(formula = Rating ~ ABV, data = beer)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -7.497 -2.156  0.359  1.667  7.018 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   74.035      3.593   20.60  &lt; 2e-16 ***
## ABV            2.260      0.612    3.69  0.00063 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.28 on 42 degrees of freedom
## Multiple R-squared:  0.245,  Adjusted R-squared:  0.227 
## F-statistic: 13.6 on 1 and 42 DF,  p-value: 0.000632</code></pre></div>
<p>Note that summarizing an <em>lm</em> object returns the estimated error standard deviation <em>sigma</em> (<span class="math inline">\(\hat{\sigma} = 3.28\)</span>), the coefficient of determination <em>r.squared</em> (<span class="math inline">\(R^2 = 0.2452\)</span>), and a <em>coefficient</em> inference table for testing <span class="math inline">\(H_0: \beta_j = 0\)</span> versus <span class="math inline">\(H_1: \beta_j \neq 0\)</span>. The observed <em>t</em> statistic for testing the slope parameter is <span class="math inline">\(t = 3.69\)</span> with 42 degrees of freedom, resulting in a p-value less than 0.001—we reject <span class="math inline">\(H_0\)</span> using any standard <span class="math inline">\(\alpha\)</span> level.</p>
<p>Use the <strong>confint</strong> function to obtain confidence intervals for regression coefficients</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">confint</span>(mod, <span class="st">&quot;ABV&quot;</span>)
##     2.5 % 97.5 %
## ABV 1.025  3.494</code></pre></div>
<p>The 95% confidence interval for <span class="math inline">\(\beta_1\)</span> reveals that we expect the average Rating to increase by 1.03 to 3.49 points for each additional 1% ABV.</p>
</div>
<div id="plot-the-regression-line" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Plot the Regression Line</h3>
<p>The <strong>abline</strong> function makes it easy to include the least-squares regression line on a scatterplot</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(beer$ABV, beer$Rating, <span class="dt">xlab =</span> <span class="st">&quot;Alcohol By Volume&quot;</span>, 
     <span class="dt">ylab =</span> <span class="st">&quot;Beer Advocate Rating&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Alcohol by Rating&quot;</span>)
<span class="kw">abline</span>(mod)</code></pre></div>
<p><img src="RWorkshop17_files/figure-html/unnamed-chunk-84-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
</div>
<div id="diagnostic-and-influence-plots" class="section level3">
<h3><span class="header-section-number">4.3.4</span> Diagnostic and Influence Plots</h3>
<p>R makes it really easy to create simple diagnostic and influence plots for a fit regression model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(mod)</code></pre></div>
<p><img src="RWorkshop17_files/figure-html/unnamed-chunk-85-1.png" width="\textwidth" style="display: block; margin: auto;" /><img src="RWorkshop17_files/figure-html/unnamed-chunk-85-2.png" width="\textwidth" style="display: block; margin: auto;" /><img src="RWorkshop17_files/figure-html/unnamed-chunk-85-3.png" width="\textwidth" style="display: block; margin: auto;" /><img src="RWorkshop17_files/figure-html/unnamed-chunk-85-4.png" width="\textwidth" style="display: block; margin: auto;" /></p>
</div>
<div id="predction-for-new-data" class="section level3">
<h3><span class="header-section-number">4.3.5</span> Predction for New Data</h3>
<p>We often want to use a fit regression model to create predictions for new data. In R, this involves first creating the data frame of new predictor scores</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">newdata &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ABV =</span> <span class="kw">seq</span>(<span class="fl">4.2</span>, <span class="fl">7.5</span>, <span class="dt">by =</span> <span class="fl">0.1</span>))</code></pre></div>
<p>which we input to the <strong>predict</strong> function along with the fit model</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">newfit &lt;-<span class="st"> </span><span class="kw">predict</span>(mod, newdata)
newfit
##     1     2     3     4     5     6     7     8     9    10    11    12 
## 83.53 83.75 83.98 84.20 84.43 84.66 84.88 85.11 85.33 85.56 85.78 86.01 
##    13    14    15    16    17    18    19    20    21    22    23    24 
## 86.24 86.46 86.69 86.91 87.14 87.37 87.59 87.82 88.04 88.27 88.50 88.72 
##    25    26    27    28    29    30    31    32    33    34 
## 88.95 89.17 89.40 89.63 89.85 90.08 90.30 90.53 90.76 90.98</code></pre></div>
<p>By default, the <strong>predict</strong> function returns a vector of predictions <span class="math inline">\(\hat{y}_{i(\mbox{new})} = \hat{\beta}_0 + \hat{\beta}_1 x_{i(\mbox{new})}\)</span>. To obtain the corresponding standard errors of the predictions, we can use the <em>se.fit</em> input</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">newfitse &lt;-<span class="st"> </span><span class="kw">predict</span>(mod, newdata, <span class="dt">se.fit =</span> <span class="ot">TRUE</span>)
newfitse
## $fit
##     1     2     3     4     5     6     7     8     9    10    11    12 
## 83.53 83.75 83.98 84.20 84.43 84.66 84.88 85.11 85.33 85.56 85.78 86.01 
##    13    14    15    16    17    18    19    20    21    22    23    24 
## 86.24 86.46 86.69 86.91 87.14 87.37 87.59 87.82 88.04 88.27 88.50 88.72 
##    25    26    27    28    29    30    31    32    33    34 
## 88.95 89.17 89.40 89.63 89.85 90.08 90.30 90.53 90.76 90.98 
## 
## $se.fit
##      1      2      3      4      5      6      7      8      9     10 
## 1.1065 1.0521 0.9985 0.9459 0.8943 0.8440 0.7952 0.7483 0.7035 0.6614 
##     11     12     13     14     15     16     17     18     19     20 
## 0.6225 0.5873 0.5567 0.5314 0.5121 0.4997 0.4946 0.4970 0.5068 0.5236 
##     21     22     23     24     25     26     27     28     29     30 
## 0.5468 0.5756 0.6092 0.6469 0.6879 0.7317 0.7779 0.8261 0.8758 0.9270 
##     31     32     33     34 
## 0.9793 1.0325 1.0866 1.1414 
## 
## $df
## [1] 42
## 
## $residual.scale
## [1] 3.28</code></pre></div>
<p>The <em>interval</em> input can be used to create confidence and prediction intervals</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">newfitCI &lt;-<span class="st"> </span><span class="kw">predict</span>(mod, newdata, <span class="dt">interval =</span> <span class="st">&quot;confidence&quot;</span>)
newfitPI &lt;-<span class="st"> </span><span class="kw">predict</span>(mod, newdata, <span class="dt">interval =</span> <span class="st">&quot;prediction&quot;</span>)
<span class="kw">head</span>(newfitCI)
##     fit   lwr   upr
## 1 83.53 81.29 85.76
## 2 83.75 81.63 85.87
## 3 83.98 81.96 85.99
## 4 84.20 82.29 86.11
## 5 84.43 82.62 86.23
## 6 84.66 82.95 86.36
<span class="kw">head</span>(newfitPI)
##     fit   lwr   upr
## 1 83.53 76.54 90.51
## 2 83.75 76.80 90.70
## 3 83.98 77.06 90.90
## 4 84.20 77.31 91.09
## 5 84.43 77.57 91.29
## 6 84.66 77.82 91.49</code></pre></div>
<p>The confidence and prediction intervals can be plotted using</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(beer$ABV, beer$Rating, <span class="dt">xlab =</span> <span class="st">&quot;Alcohol By Volume&quot;</span>, 
     <span class="dt">ylab =</span> <span class="st">&quot;Beer Advocate Rating&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Alcohol by Rating&quot;</span>,
     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">75</span>, <span class="dv">100</span>))
<span class="kw">lines</span>(newdata$ABV, newfitCI[,<span class="dv">1</span>])
<span class="kw">lines</span>(newdata$ABV, newfitCI[,<span class="dv">2</span>], <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)
<span class="kw">lines</span>(newdata$ABV, newfitCI[,<span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)
<span class="kw">lines</span>(newdata$ABV, newfitPI[,<span class="dv">2</span>], <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">lines</span>(newdata$ABV, newfitPI[,<span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">lty =</span> <span class="dv">1</span>:<span class="dv">3</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;fit&quot;</span>, <span class="st">&quot;95% CI&quot;</span>, <span class="st">&quot;95% PI&quot;</span>),
       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</code></pre></div>
<p><img src="RWorkshop17_files/figure-html/unnamed-chunk-90-1.png" width="\textwidth" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="multiple-linear-regression" class="section level2">
<h2><span class="header-section-number">4.4</span> Multiple Linear Regression</h2>
<div id="overview-3" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Overview</h3>
<p>A multiple linear regression model has the form <span class="math display">\[
y_i = \beta_0 + \sum_{j=1}^p \beta_j x_{ij} + \epsilon_i
\]</span> where <span class="math inline">\(y_i\)</span> is the response for the <span class="math inline">\(i\)</span>-th observation, <span class="math inline">\(x_{ij}\)</span> is the <em>j</em>-th predictor for the <em>i</em>-th observation, <span class="math inline">\(\beta_0\)</span> is the unknown regression intercept, <span class="math inline">\(\beta_j\)</span> is the unknown regression slope for the <em>j</em>-th predictor, and <span class="math inline">\(\epsilon_i \sim \mathrm{N}(0, \sigma^2)\)</span> is a latent Gaussian error term. Note that <span class="math inline">\(\beta_j\)</span> gives the expected change in the response variable for a 1-unit change in the <em>j</em>-th predictor variable conditioned on the other predictors, i.e., holding all other predictors constant.</p>
</div>
<div id="additive-effects" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Additive Effects</h3>
<p>We will start by considering a model predicting the Rating from the additive effects of ABV and Brewery</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">amod &lt;-<span class="st"> </span><span class="kw">lm</span>(Rating ~<span class="st"> </span>ABV +<span class="st"> </span>Brewery, <span class="dt">data =</span> beer)</code></pre></div>
<p>Note that this model allows each Brewery to have a unique regression intercept (Bauhaus is the baseline), but assumes that the slope between ABV and Rating is the same for each Brewery. We can summarize the model using the same approach as before:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">amodsum &lt;-<span class="st"> </span><span class="kw">summary</span>(amod)
amodsum
## 
## Call:
## lm(formula = Rating ~ ABV + Brewery, data = beer)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -4.702 -1.477  0.217  1.207  5.505 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           77.8216     3.2784   23.74   &lt;2e-16 ***
## ABV                    1.5873     0.5342    2.97   0.0053 ** 
## BreweryBent Paddle     1.0167     1.7600    0.58   0.5672    
## BreweryFulton         -2.2786     1.7592   -1.30   0.2037    
## BreweryIndeed          0.8747     1.6455    0.53   0.5984    
## BrewerySteel Toe       0.0596     1.8970    0.03   0.9751    
## BrewerySummit         -1.1684     1.6444   -0.71   0.4821    
## BrewerySurly           4.2534     1.6877    2.52   0.0164 *  
## BreweryUrban Growler  -3.2278     1.7615   -1.83   0.0754 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.62 on 35 degrees of freedom
## Multiple R-squared:  0.598,  Adjusted R-squared:  0.506 
## F-statistic: 6.51 on 8 and 35 DF,  p-value: 3.5e-05</code></pre></div>
<p>Compared to the simple linear regression model containing only the ABV predictor, we have noticeably reduced the residual standard deviation estimate <em>sigma</em> (<span class="math inline">\(\hat{\sigma} = 2.622\)</span>) and increased the coefficient of (multiple) determination <em>r.squared</em> (<span class="math inline">\(R^2 = 0.5979\)</span>).</p>
<p>The <strong>anova</strong> and <strong>Anova</strong> functions can be used to test the significance of terms</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(car)
## 
## Attaching package: &#39;car&#39;
## The following object is masked from &#39;package:dplyr&#39;:
## 
##     recode
<span class="kw">anova</span>(amod)  <span class="co"># Type I (sequential) SS test</span>
## Analysis of Variance Table
## 
## Response: Rating
##           Df Sum Sq Mean Sq F value Pr(&gt;F)    
## ABV        1    147   146.8   21.35  5e-05 ***
## Brewery    7    211    30.2    4.39 0.0014 ** 
## Residuals 35    241     6.9                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
<span class="kw">Anova</span>(amod)  <span class="co"># Type II SS test</span>
## Anova Table (Type II tests)
## 
## Response: Rating
##           Sum Sq Df F value Pr(&gt;F)   
## ABV         60.7  1    8.83 0.0053 **
## Brewery    211.1  7    4.39 0.0014 **
## Residuals  240.7 35                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre></div>
<p>Note that <strong>anova</strong> tests the effects sequentially (ABV alone, then Brewery given ABV), whereas the <strong>Anova</strong> function (in the <em>car</em> package) tests the effects conditioned on the other effect (ABV given Brewery, Brewery given ABV). Using the Type II tests from the <strong>Anova</strong> function, we see that both ABV (<span class="math inline">\(F_{1,35} = 8.83, p = 0.005\)</span>) and Brewery (<span class="math inline">\(F_{7,35} = 4.39, p = 0.001\)</span>) significantly add to the prediction of the beer’s Rating.</p>
</div>
<div id="interaction-effects" class="section level3">
<h3><span class="header-section-number">4.4.3</span> Interaction Effects</h3>
<p>Next we consider a model predicting the Rating from the interaction effects of ABV and Brewery</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">imod &lt;-<span class="st"> </span><span class="kw">lm</span>(Rating ~<span class="st"> </span>ABV *<span class="st"> </span>Brewery, <span class="dt">data =</span> beer)</code></pre></div>
<p>Note that formula notation is shorthand for <em>Rating ~ ABV + Brewery + ABV:Brewery</em>, so this model allows each Brewery to have a unique regression intercept and slope relating ABV and Rating. We can summarize the model using the same approach as before:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">imodsum &lt;-<span class="st"> </span><span class="kw">summary</span>(imod)
imodsum
## 
## Call:
## lm(formula = Rating ~ ABV * Brewery, data = beer)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -5.291 -1.304 -0.047  1.477  4.943 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                90.420     12.410    7.29  6.2e-08 ***
## ABV                        -0.653      2.192   -0.30     0.77    
## BreweryBent Paddle        -17.065     17.824   -0.96     0.35    
## BreweryFulton             -18.885     14.606   -1.29     0.21    
## BreweryIndeed              -8.170     14.412   -0.57     0.58    
## BrewerySteel Toe          -16.653     16.604   -1.00     0.32    
## BrewerySummit             -11.251     15.783   -0.71     0.48    
## BrewerySurly              -12.048     14.679   -0.82     0.42    
## BreweryUrban Growler       -8.655     19.727   -0.44     0.66    
## ABV:BreweryBent Paddle      3.233      3.182    1.02     0.32    
## ABV:BreweryFulton           2.958      2.581    1.15     0.26    
## ABV:BreweryIndeed           1.624      2.527    0.64     0.53    
## ABV:BrewerySteel Toe        2.885      2.784    1.04     0.31    
## ABV:BrewerySummit           1.785      2.807    0.64     0.53    
## ABV:BrewerySurly            2.824      2.511    1.12     0.27    
## ABV:BreweryUrban Growler    1.003      3.428    0.29     0.77    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.81 on 28 degrees of freedom
## Multiple R-squared:  0.63,   Adjusted R-squared:  0.431 
## F-statistic: 3.17 on 15 and 28 DF,  p-value: 0.00403</code></pre></div>
<p>Compared to the additive model, we have slightly increased the residual standard deviation estimate <em>sigma</em> (<span class="math inline">\(\hat{\sigma} = 2.813\)</span>) and increased the coefficient of (multiple) determination <em>r.squared</em> (<span class="math inline">\(R^2 = 0.6297\)</span>).</p>
<p>Use the <strong>Anova</strong> function to test the signifiance of the effects</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(car)
<span class="kw">Anova</span>(imod)  <span class="co"># Type II SS test</span>
## Anova Table (Type II tests)
## 
## Response: Rating
##             Sum Sq Df F value Pr(&gt;F)   
## ABV           60.7  1    7.67 0.0099 **
## Brewery      211.1  7    3.81 0.0050 **
## ABV:Brewery   19.0  7    0.34 0.9267   
## Residuals    221.6 28                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre></div>
<p>The results reveal that the interaction effect is not significant (<span class="math inline">\(F_{7,28} = 0.34, p = 0.927\)</span>), but the main effects of ABV (<span class="math inline">\(F_{1,28} = 7.67, p = 0.01\)</span>) and Brewery (<span class="math inline">\(F_{7,28} = 3.81, p = 0.005\)</span>) are significant at the classic <span class="math inline">\(\alpha = 0.05\)</span> significance level.</p>
</div>
<div id="comparing-fit-models" class="section level3">
<h3><span class="header-section-number">4.4.4</span> Comparing Fit Models</h3>
<p>To compare the fit models, we can use the <strong>anova</strong> function for <em>F</em>-tests</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(mod, amod, imod)
## Analysis of Variance Table
## 
## Model 1: Rating ~ ABV
## Model 2: Rating ~ ABV + Brewery
## Model 3: Rating ~ ABV * Brewery
##   Res.Df RSS Df Sum of Sq    F Pr(&gt;F)   
## 1     42 452                            
## 2     35 241  7       211 3.81  0.005 **
## 3     28 222  7        19 0.34  0.927   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre></div>
<p>or the <strong>AIC</strong> function to extract Akaike’s information criterion</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">AIC</span>(mod, amod, imod)
##      df   AIC
## mod   3 233.3
## amod 10 219.6
## imod 17 230.0</code></pre></div>
<p>In this case, the <em>F</em>-tests and AIC values suggest that the additive model should be preferred. We conclude that each Brewery has a unique baseline Rating, and increasing the ABV by 1% corresponds to an expected 1.59 point increase in the Rating.</p>
</div>
</div>
<div id="exercises-3" class="section level2">
<h2><span class="header-section-number">4.5</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li>Load the Minnesota Beer Data into R.</li>
<li>Make a scatterplot of the IBU (x-axis) by Rating (y-axis)</li>
<li>Fit a simple linear regression model predicting Rating from IBU.</li>
<li>Is there a significant linear relationship between IBU and Rating?</li>
<li>Plot the linear relationship, along with 95% confidence and prediction intervals.</li>
<li>Fit a multiple linear regression model predicting Rating from the additive effects of IBU and Brewery.</li>
<li>Fit a multiple linear regression model predicting Rating from the additive and interaction effects of IBU and Brewery.</li>
<li>Considering the models you fit in Ex 3, 7, 8, which do you prefer and why?</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simple-statistics-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="using-r-reproducibly.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"download": null,
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
